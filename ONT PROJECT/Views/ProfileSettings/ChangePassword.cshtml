@model ONT_PROJECT.Models.TblUser
@{
    ViewData["Title"] = "Change Password";
    Layout = "_CustomerLayout";
}

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">

<div class="container d-flex justify-content-center align-items-center" style="min-height: 70vh;">
    <div class="card shadow-sm p-4" style="width: 400px; background: #fff; border-radius: 8px;">
        <!-- Back Button -->
        <div class="mb-3 text-start">
            <a asp-controller="ProfileSettings" asp-action="Index" class="btn btn-secondary btn-sm">
                <i class="bi bi-arrow-left me-1"></i> Back
            </a>
        </div>

        <h3 class="text-center mb-4" style="color: #566787; font-family: 'Varela Round', sans-serif;">Change Password</h3>

        <div id="errorMessages" class="alert alert-danger d-none"></div>

        <form id="changePasswordForm" asp-action="ChangePassword" method="post">
            @Html.AntiForgeryToken()
            <input type="hidden" name="UserId" value="@Model.UserId" />

            <div class="mb-3">
                <label for="Password" class="form-label">Current Password</label>
                <input type="password" class="form-control" id="Password" name="Password" required />
            </div>

            <div class="mb-3">
                <label for="NewPassword" class="form-label">New Password</label>
                <input type="password" class="form-control" id="NewPassword" name="NewPassword" required />
            </div>

            <div class="mb-3">
                <label for="ConfirmPassword" class="form-label">Confirm New Password</label>
                <input type="password" class="form-control" id="ConfirmPassword" name="ConfirmPassword" required />
            </div>

            <button type="submit" class="btn w-100" style="background: #4b5366; color: #fff; font-weight: bold;">
                Update Password
            </button>
        </form>
    </div>
</div>

<script>
    document.getElementById("changePasswordForm").addEventListener("submit", function (e) {
        let errors = [];
        const newPassword = document.getElementById("NewPassword").value;
        const confirmPassword = document.getElementById("ConfirmPassword").value;

        if (newPassword.length < 6) {
            errors.push("New password must be at least 6 characters long.");
        }

        if (newPassword !== confirmPassword) {
            errors.push("New password and confirmation do not match.");
        }

        if (errors.length > 0) {
            e.preventDefault();
            const errorDiv = document.getElementById("errorMessages");
            errorDiv.innerHTML = errors.join("<br>");
            errorDiv.classList.remove("d-none");
        }
    });
</script>

<style>
    body {
        font-family: 'Varela Round', sans-serif;
        color: #566787;
        background: #f5f5f5;
        font-size: 13px;
    }

    .form-control {
        border-radius: 5px;
    }

    .btn:hover {
        opacity: 0.85;
        text-decoration: none;
        color: #fff !important;
    }
</style>
