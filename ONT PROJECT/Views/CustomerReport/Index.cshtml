@{
    ViewData["Title"] = "Dashboard";
    Layout = "_CustomerLayout";
}

@model ONT_PROJECT.Models.TblUser

<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h2 class="text-center mb-4">Edit Your Profile</h2>

            <!-- No real submission, just display -->
            <form>
                <div class="form-group mb-3">
                    <label>First Name</label>
                    <input type="text" class="form-control" value="@Model.FirstName" />
                </div>

                <div class="form-group mb-3">
                    <label>Last Name</label>
                    <input type="text" class="form-control" value="@Model.LastName" />
                </div>

                <div class="form-group mb-3">
                    <label>ID Number</label>
                    <input type="text" class="form-control" value="@Model.Idnumber" />
                </div>

                <div class="form-group mb-3">
                    <label>Phone Number</label>
                    <input type="text" class="form-control" value="@Model.PhoneNumber" />
                </div>

                <div class="form-group mb-3">
                    <label>Email</label>
                    <input type="email" class="form-control" value="@Model.Email" />
                </div>

                <!-- Allergy Dropdown & Add/Delete -->
                <div class="form-group mb-4">
                    <label>Allergies</label>

                    <div class="d-flex">
                        <select id="allergySelect" class="form-control me-2">
                            <option value="Penicillin">Penicillin</option>
                            <option value="Peanuts">Peanuts</option>
                            <option value="Dust">Dust</option>
                            <option value="Pollen">Pollen</option>
                            <option value="Gluten">Gluten</option>
                        </select>
                        <button type="button" class="btn btn-success" onclick="addAllergy()">Add</button>
                    </div>

                    <ul id="allergyList" class="list-group mt-2">
                        @if (!string.IsNullOrEmpty(Model.Allergies))
                        {
                            var allergies = Model.Allergies.Split(',');
                            foreach (var allergy in allergies)
                            {
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    @allergy
                                    <button type="button" class="btn btn-sm btn-danger" onclick="removeAllergy(this)">Remove</button>
                                </li>
                            }
                        }
                    </ul>
                </div>

                <button type="button" class="btn btn-primary w-100 text-uppercase" onclick="alert('Changes saved temporarily!')">Save Changes</button>
            </form>
        </div>
    </div>
</div>

@* @section Scripts { *@
    <script>
        function addAllergy() {
            const select = document.getElementById("allergySelect");
            const selectedValue = select.value;

            // Check if already added
            const listItems = document.querySelectorAll("#allergyList li");
            for (let item of listItems) {
                if (item.textContent.includes(selectedValue)) {
                    alert("Allergy already added.");
                    return;
                }
            }

            const li = document.createElement("li");
            li.className = "list-group-item d-flex justify-content-between align-items-center";
            li.innerHTML = selectedValue +
                '<button type="button" class="btn btn-sm btn-danger" onclick="removeAllergy(this)">Remove</button>';

            document.getElementById("allergyList").appendChild(li);
        }

        function removeAllergy(button) {
            button.parentElement.remove();
        }
    </script>
}
